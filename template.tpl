___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.

___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "XO Multi-Activity Tracking",
  "categories": [
    "ANALYTICS",
    "ATTRIBUTION",
    "CONVERSIONS",
    "DATA_WAREHOUSING",
    "EXPERIMENTATION",
    "PERSONALIZATION"
  ],
  "brand": {
    "id": "attraqt",
    "displayName": "Attraqt",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWIAAAFiCAYAAADMXNJ6AAAACXBIWXMAAC4jAAAuIwF4pT92AAAF4WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTAxLTI3VDE3OjI3OjU3WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0wMS0yN1QxNzoyNzo1N1oiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTAxLTI3VDE3OjI3OjU3WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozZTU5NTNlNS05MzFlLWI2NDYtYjg3MC01ZmExMTA2Zjg5YmYiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo5MDRiOTA0Ny1hMGYxLWY5NDUtYmMyNi1hYTJkZDY4NjFhZGMi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\u003d"
  },
  "description": "Collect and unify several user activities in real-time from every touchpoint of the Customer Journey, for both Attraqt\u0027s platforms, XO and FHR.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "GROUP",
    "name": "mandatory",
    "displayName": "Required parameters",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "trackerKey",
        "displayName": "Tracker key",
        "simpleValueType": true,
        "valueHint": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ],
        "help": "This identifier is available on the platform once your account is created.",
        "canBeEmptyString": false
      },
      {
        "type": "TEXT",
        "name": "region",
        "displayName": "Region (optional)",
        "simpleValueType": true,
        "help": "The region in which your data is stored: currently only eu is available.",
        "defaultValue": "eu"
      },
      {
        "type": "TEXT",
        "name": "verb",
        "displayName": "Action",
        "simpleValueType": true,
        "defaultValue": "purchase",
        "help": "The action performed by the user that triggered the event."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "user",
    "displayName": "User information",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "PARAM_TABLE",
        "name": "identities",
        "displayName": "Identities",
        "paramTableColumns": [
          {
            "param": {
              "type": "TEXT",
              "name": "identity",
              "displayName": "Identity repository",
              "simpleValueType": true,
              "valueValidators": [
                {
                  "type": "NON_EMPTY"
                },
                {
                  "type": "REGEX",
                  "args": [
                    "^[a-z0-9]*$"
                  ],
                  "errorMessage": "Identity repositories must contain only lower case alphanumeric characters."
                }
              ],
              "help": "The identity repository defined by a slug. e.g. userid"
            },
            "isUnique": true
          },
          {
            "param": {
              "type": "SELECT",
              "name": "identityVal",
              "displayName": "Identity",
              "macrosInSelect": true,
              "selectItems": [],
              "simpleValueType": true,
              "help": "The user id from the repository. e.g. 123456"
            },
            "isUnique": false
          }
        ],
        "help": "User ids in each identity repository (sessionId, crmId, ecommerceId, email...).",
        "newRowTitle": "New identity",
        "newRowButtonText": "Add identity"
      },
      {
        "type": "GROUP",
        "name": "user segments",
        "displayName": "User segments",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "SELECT",
            "name": "userSegments",
            "displayName": "Segments",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "notSetText": "Not set"
          },
          {
            "type": "TEXT",
            "name": "userSegmentsSeparator",
            "displayName": "Segment separator",
            "simpleValueType": true,
            "defaultValue": ",",
            "help": "The character used to separate values"
          }
        ],
        "help": "List of user segments. e.g. gender, status, user type"
      },
      {
        "type": "PARAM_TABLE",
        "name": "traits",
        "displayName": "Traits",
        "paramTableColumns": [
          {
            "param": {
              "type": "TEXT",
              "name": "trait",
              "displayName": "Name",
              "simpleValueType": true,
              "help": "Name of the trait. e.g. age"
            },
            "isUnique": true
          },
          {
            "param": {
              "type": "SELECT",
              "name": "traitVal",
              "displayName": "Value",
              "macrosInSelect": true,
              "selectItems": [],
              "simpleValueType": true,
              "help": "Value of the trait. e.g. 32"
            },
            "isUnique": false
          }
        ],
        "help": "Free object for user informations. (ex : Age \u003d 32)",
        "newRowTitle": "New trait",
        "newRowButtonText": "Add trait"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "activity",
    "displayName": "Activities information",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "GROUP",
        "name": "specific",
        "displayName": "Targets",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "SELECT",
            "name": "targets",
            "displayName": "Target list",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "A list of targets, each target is represented by an object."
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "attributes",
            "displayName": "Attributes",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Key in XO Activity Object",
                "name": "name",
                "type": "TEXT"
              },
              {
                "defaultValue": "",
                "displayName": "Key in input object",
                "name": "key",
                "type": "TEXT"
              },
              {
                "defaultValue": "metadata",
                "displayName": "Type of attribute in XO Activity Object",
                "name": "type",
                "type": "SELECT",
                "selectItems": [
                  {
                    "value": "metadata",
                    "displayValue": "Metadata"
                  },
                  {
                    "value": "target",
                    "displayValue": "Target"
                  }
                ]
              }
            ],
            "help": "How to map the attributes from your objects to XO Activity Objects"
          }
        ],
        "help": "Targets can be products or categories for example."
      },
      {
        "type": "GROUP",
        "name": "global",
        "displayName": "Common",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "SELECT",
            "name": "sourceId",
            "displayName": "Source id",
            "macrosInSelect": true,
            "selectItems": [],
            "simpleValueType": true,
            "help": "The source that generated the tracked object.",
            "notSetText": "Not set"
          },
          {
            "type": "GROUP",
            "name": "activity segments",
            "displayName": "",
            "groupStyle": "NO_ZIPPY",
            "subParams": [
              {
                "type": "SELECT",
                "name": "activitySegments",
                "displayName": "Segments",
                "macrosInSelect": true,
                "selectItems": [],
                "simpleValueType": true,
                "notSetText": "Not set"
              },
              {
                "type": "TEXT",
                "name": "activitySegmentsSeparator",
                "displayName": "Segment separator",
                "simpleValueType": true,
                "defaultValue": ","
              }
            ]
          },
          {
            "type": "SIMPLE_TABLE",
            "name": "commonMetadata",
            "displayName": "Common metadata of XO Activity Objects",
            "simpleTableColumns": [
              {
                "defaultValue": "",
                "displayName": "Key",
                "name": "name",
                "type": "TEXT"
              },
              {
                "defaultValue": "",
                "displayName": "Value",
                "name": "value",
                "type": "TEXT"
              }
            ]
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const createQueue = require("createQueue");
const injectScript = require("injectScript");
const copyFromWindow = require("copyFromWindow");
const callInWindow = require("callInWindow");
const Object = require("Object");
const getType = require("getType");

// functions
const notNullOrEmpty = (value) => {
  return value !== "" && value !== null && typeof value !== "undefined";
};

const objArrayFactory = (array, keyKey, valueKey) => {
  const newobj = {};
  if (array && array.length > 0) {
    array.forEach((t) => {
      const key = t[keyKey];
      const val = t[valueKey];
      if (notNullOrEmpty(key) && notNullOrEmpty(val)) {
        newobj[key] = val;
      }
    });
  }
  return newobj;
};

const shallowMerge = (output, objectList) => {
  objectList.forEach((object) =>
    Object.entries(object).reduce((prev, current) => {
      prev[current[0]] = current[1];
      return prev;
    }, output)
  );
  return output;
};

const arrayOrSplit = (input, separator) => {
  if (getType(input) === "array") return input;
  return input ? input.split(separator) : [];
};
// set lib URL
const isIe = false;
const url = "https://cdn.attraqt.io/xo.activity-";
const version = "1.8.3";
const compat = isIe ? ".compat.min.js" : ".min.js";
const finalLibrary = url + version + compat;

// createQueue and set _attraqt
const pushQ = createQueue("_attraqt");

if (copyFromWindow("xo.activity.isInitialized") !== true) {
  const initOptions = { trackerKey: data.trackerKey };
  if (data.region && data.region !== "") {
    initOptions.region = data.region;
  }
  pushQ(["init", initOptions]);
}

// set user
if (data.identities && data.identities.length > 0) {
  data.identities.forEach((ident) => {
    const arr = ["addUserIdentity", ident.identity, ident.identityVal];
    if (notNullOrEmpty(ident.identity) && notNullOrEmpty(ident.identityVal)) {
      pushQ(arr);
    }
  });
}
pushQ([
  "setUserSegments",
  arrayOrSplit(data.userSegments, data.userSegmentsSeparator),
]);
pushQ(["setUserTraits", objArrayFactory(data.traits, "trait", "traitVal")]);

// set activity

const activities = [];
// convert input object into activities
data.targets.forEach((target) => {
  const productTargets = {};
  const productMetadata = {};
  (data.attributes || []).forEach((attribute) => {
    const key = attribute.name;
    const val = target[attribute.key];
    if (notNullOrEmpty(key) && notNullOrEmpty(val)) {
      if (attribute.type === "target") {
        productTargets[key] = val;
      } else if (attribute.type === "metadata") {
        productMetadata[key] = val;
      }
    }
  });
  const metadatas = shallowMerge({}, [
    objArrayFactory(data.commonMetadata, "name", "value"),
    productMetadata,
  ]);
  const activity = shallowMerge({}, [
    {
      action: data.verb,
      target: productTargets,
      metadata: metadatas,
      segments: arrayOrSplit(
        data.activitySegments,
        data.activitySegmentsSeparator
      ),
    },
    data.sourceId ? { sourceId: data.sourceId } : {},
  ]);
  activities.push(activity);
});
pushQ(["sendAndStoreClusters", activities]);

if (copyFromWindow("xo.activity.isInitialized")) {
  callInWindow("xo.activity.handleQueuedEvents", "");
}

injectScript(finalLibrary, data.gtmOnSuccess, data.gtmOnFailure, "attraqtLib");


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "_attraqt"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "xo.activity.isInitialized"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "xo.activity.handleQueuedEvents"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.attraqt.io/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Activities
  code: "const mockData = {\n  trackerKey: \"tracker-key\",\n  region: \"eu\",\n \
    \ verb: \"buy\",\n  targets: [\n    {\n      pid: \"id-1\",\n      qte: 2,\n \
    \     prix: 12300,\n    },\n    {\n      pid: \"id-2\",\n      qte: 10,\n    \
    \  prix: 199,\n    },\n  ],\n  attributes: [\n    {\n      name: \"product\",\n\
    \      key: \"pid\",\n      type: \"target\",\n    },\n    {\n      name: \"quantity\"\
    ,\n      key: \"qte\",\n      type: \"metadata\",\n    },\n    {\n      name:\
    \ \"price\",\n      key: \"prix\",\n      type: \"metadata\",\n    },\n  ],\n\
    \  commonMetadata: [\n    {\n      name: \"orderId\",\n      value: \"12345-6789\"\
    ,\n    },\n    {\n      name: \"currency\",\n      value: \"EUR\",\n    },\n \
    \   {\n      name: \"locale\",\n      value: \"en_GB\",\n    },\n  ],\n  activitySegments:\
    \ [\"seg-a\", \"seg-b\"],\n};\n\nconst activitiesToSend = [];\n\nmock(\"createQueue\"\
    , () => {\n  return (args) => {\n    const cmd = args[0];\n    if (cmd === \"\
    sendAndStoreClusters\") {\n      activitiesToSend.push(args[1]);\n    }\n  };\n\
    });\n\n// Call runCode to run the template's code.\nrunCode(mockData);\n\n// Check\
    \ only one call to \nassertThat(activitiesToSend.length).isEqualTo(1);\nassertThat(activitiesToSend[0]).isEqualTo([\n\
    \  {\n    action: \"buy\",\n    target: { product: \"id-1\" },\n    metadata:\
    \ {\n      currency: \"EUR\",\n      locale: \"en_GB\",\n      quantity: 2,\n\
    \      price: 12300,\n      orderId: \"12345-6789\",\n    },\n    segments: [\"\
    seg-a\", \"seg-b\"],\n  },\n  {\n    action: \"buy\",\n    target: { product:\
    \ \"id-2\" },\n    metadata: {\n      currency: \"EUR\",\n      locale: \"en_GB\"\
    ,\n      quantity: 10,\n      price: 199,\n      orderId: \"12345-6789\",\n  \
    \  },\n    segments: [\"seg-a\", \"seg-b\"],\n  },\n]);\n"


___NOTES___

Created on 09/04/2020 à 14:36:43


